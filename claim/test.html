<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLRT Vesting</title>
</head>
<body>
    <h1>PLRT Vesting</h1>
    <div id="walletInfo"></div>
    <div id="messageInfo"></div>

    <script src="https://cdn.jsdelivr.net/npm/web3@1.8.2/dist/web3.min.js"></script>
    <script>
        let web3;

        // Initialize Web3
        async function initWeb3() {
            if (window.ethereum) {
                web3 = new Web3(window.ethereum);
                try {
                    await window.ethereum.request({ method: 'eth_requestAccounts' });
                } catch (error) {
                    console.error("User denied account access");
                }
            } else if (window.web3) {
                web3 = new Web3(window.web3.currentProvider);
            } else {
                console.log('Non-Ethereum browser detected. You should consider trying MetaMask!');
            }
        }

        // Contract address and ABI
        const contractAddress = '0xB4308847b8060CB63463aa96bBbbbB23e958aeFa'; // Replace with your contract address
        const contractABI = [
            // ... (Contract ABI goes here)
        ];

        async function main() {
            await initWeb3();

            // Instantiate contract
            const contract = new web3.eth.Contract(contractABI, contractAddress);

            // Get user's wallet address
            const accounts = await web3.eth.getAccounts();
            const userAddress = accounts[0];

            // Get vesting details for the user
            const teamMemberDetails = await contract.methods.getTeamMemberVestingDetails(userAddress).call();
            const privateSaleNFTDetails = await contract.methods.getPrivateSaleNFTVestingDetails(userAddress).call();
            const treasuryDetails = await contract.methods.getTreasuryVestingDetails().call();

            // Display vesting data
            document.getElementById('walletInfo').innerHTML = `
                <h2>Wallet Address: ${userAddress}</h2>

                <div>
                    <h3>Team Member Vesting Details:</h3>
                    <p>Total Allocation: ${teamMemberDetails[0]}</p>
                    <p>Claimed Amount: ${teamMemberDetails[1]}</p>
                    <p>Remaining Claimable Amount: ${teamMemberDetails[2]}</p>
                </div>

                <div>
                    <h3>Private Sale NFT Vesting Details:</h3>
                    <p>Total Allocation: ${privateSaleNFTDetails[0]}</p>
                    <p>Claimed Amount: ${privateSaleNFTDetails[1]}</p>
                    <p>Remaining Claimable Amount: ${privateSaleNFTDetails[2]}</p>
                </div>

                <div>
                    <h3>Treasury Vesting Details:</h3>
                    <p>Total Allocation: ${treasuryDetails[0]}</p>
                    <p>Claimed Amount: ${treasuryDetails[1]}</p>
                    <p>Remaining Claimable Amount: ${treasuryDetails[2]}</p>
                </div>
            `;
        }

        main().catch(console.error);

        // Send a message to the Ethereum blockchain
        async function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value.trim();

            if (!message) {
                document.getElementById('messageInfo').innerHTML = '<p>Please enter a message.</p>';
                return;
            }

            try {
                const accounts = await web3.eth.getAccounts();
                const userAddress = accounts[0];

                // Replace the following code with your logic to send the message
                // to the Ethereum blockchain using the connected account
                console.log(`Message from ${userAddress}: ${message}`);

                document.getElementById('messageInfo').innerHTML = '<p>Message sent successfully!</p>';
                messageInput.value = '';
            } catch (error) {
                console.error(error);
                document.getElementById('messageInfo').innerHTML = '<p>Error sending message.</p>';
            }
        }
    </script>

    <div>
        <h3>Send a Message</h3>
        <input type="text" id="messageInput" placeholder="Enter a message">
        <button onclick="sendMessage()">Send</button>
    </div>
</body>
</html>
