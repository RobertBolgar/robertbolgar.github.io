<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLRT Token Withdrawal</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@metamask/detect-provider@1.0.0/dist/index.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.min.js"></script>
</head>
<body>
    <header>
        <h1>Withdraw Your Vested PLRT Tokens</h1>
    </header>

    <main>
        <section class="wallet-connect">
            <h2>Connect Your Wallet to Withdraw PLRT Tokens</h2>
            <button id="connectWalletButton" class="button">Connect Wallet</button>
            <div id="walletAddressDisplay" class="info-item" style="display: none;">
                <label>Your Connected Wallet Address:</label>
                <span id="walletAddress"></span>
            </div>
            <button id="withdrawTokensButton" class="button" style="display: none;">Withdraw Tokens</button>
            <p id="withdrawalStatus"></p>
        </section>
        
        <script src="custom-script.js"></script>
        <script>
            const contractAddress = "YOUR_SMART_CONTRACT_ADDRESS";
            const contractABI = ABI_OF_YOUR_CONTRACT;

            async function connectWallet() {
                const provider = await detectEthereumProvider();
                if (provider) {
                    try {
                        const accounts = await provider.request({ method: 'eth_requestAccounts' });
                        const account = accounts[0];
                        document.getElementById('walletAddress').innerText = account;
                        document.getElementById('walletAddressDisplay').style.display = 'block';
                        document.getElementById('withdrawTokensButton').style.display = 'block';
                    } catch (error) {
                        console.error(error);
                    }
                } else {
                    console.log('Please install MetaMask!');
                }
            }

            async function withdrawTokens() {
                const provider = new ethers.providers.Web3Provider(window.ethereum);
                const signer = provider.getSigner();
                const contract = new ethers.Contract(contractAddress, contractABI, signer);

                try {
                    const tx = await contract.withdrawTokens(); // Assuming `withdrawTokens` is the function in your contract
                    await tx.wait();
                    document.getElementById('withdrawalStatus').innerText = 'Withdrawal successful!';
                } catch (error) {
                    console.error(error);
                    document.getElementById('withdrawalStatus').innerText = 'Withdrawal failed. See console for details.';
                }
            }

            document.getElementById('connectWalletButton').addEventListener('click', connectWallet);
            document.getElementById('withdrawTokensButton').addEventListener('click', withdrawTokens);

            window.addEventListener('load', async () => {
                // Additional initialization if needed
            });
        </script>
    </main>

    <footer>
        <p>&copy; 2024 PLRT Token. Redefining Digital Content & Rewards.</p>
    </footer>
</body>
</html>
